<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>EvidenceGap Radar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="data:," />
  <link rel="stylesheet" href="styles.css?v=20260217_5" />
</head>

<body>

  <header class="header">
    <h1>EvidenceGap Radar</h1>
    <p class="author">Creado por Ramón Morillo · Febrero 2026</p>
  </header>

  <main class="container">

    <!-- Texto explicativo -->
    <section class="card" style="margin-bottom: 16px;">
      <h2 style="margin-top:0;">¿Qué es esta herramienta?</h2>
      <p style="margin: 0; opacity: 0.9; line-height: 1.45;">
        EvidenceGap Radar genera una <b>fotografía rápida</b> del "paisaje de evidencia" de una pregunta tipo PICO-lite,
        combinando señales de <b>PubMed</b> (publicaciones recientes + histórico) y <b>ClinicalTrials.gov</b> (ensayos).
      </p>
      <p style="margin: 10px 0 0; opacity: 0.75; line-height: 1.45;">
        Útil para docencia y para orientar búsquedas. <b>No sustituye</b> lectura crítica ni evaluación metodológica.
      </p>
    </section>

    <!-- PICO-lite form -->
    <section class="card">
      <div class="form-header">
        <h2>PICO-lite</h2>
        <div class="form-header-right">
          <div class="mesh-toggle">
            <label class="toggle-label">
              <input type="checkbox" id="meshToggle" />
              <span class="toggle-switch"></span>
              <span>MeSH-only (estricto)</span>
            </label>
          </div>
          <div class="example-bar" id="exampleBar">
            <label>Ejemplos:</label>
            <select id="exampleSelector">
              <option value="">— Seleccionar —</option>
            </select>
          </div>
        </div>
      </div>

      <!-- MeSH mode notice -->
      <div id="meshNotice" class="mesh-notice hidden">
        Solo términos MeSH. Escribe para buscar en el vocabulario MeSH y selecciona del desplegable.
      </div>

      <div class="grid">
        <div class="field">
          <label>Población</label>
          <div class="autocomplete-wrap">
            <input id="population" type="text" placeholder="Ej: pacientes VIH" autocomplete="off" />
            <div class="ac-dropdown hidden" id="acDrop-population"></div>
          </div>
          <div class="mesh-chips hidden" id="meshChips-population"></div>
          <div class="syn-area" id="synArea-population">
            <div class="syn-chips" id="synChips-population"></div>
            <input class="syn-input" data-field="population" placeholder="+ sinónimo (Enter)" />
          </div>
        </div>

        <div class="field">
          <label>Intervención / Exposición</label>
          <div class="autocomplete-wrap">
            <input id="intervention" type="text" placeholder="Ej: telefarmacia" autocomplete="off" />
            <div class="ac-dropdown hidden" id="acDrop-intervention"></div>
          </div>
          <div class="mesh-chips hidden" id="meshChips-intervention"></div>
          <div class="syn-area" id="synArea-intervention">
            <div class="syn-chips" id="synChips-intervention"></div>
            <input class="syn-input" data-field="intervention" placeholder="+ sinónimo (Enter)" />
          </div>
        </div>

        <div class="field">
          <label>Outcome</label>
          <div class="autocomplete-wrap">
            <input id="outcome" type="text" placeholder="Ej: adherencia" autocomplete="off" />
            <div class="ac-dropdown hidden" id="acDrop-outcome"></div>
          </div>
          <div class="mesh-chips hidden" id="meshChips-outcome"></div>
          <div class="syn-area" id="synArea-outcome">
            <div class="syn-chips" id="synChips-outcome"></div>
            <input class="syn-input" data-field="outcome" placeholder="+ sinónimo (Enter)" />
          </div>
        </div>

        <div class="field">
          <label>Contexto (opcional)</label>
          <div class="autocomplete-wrap">
            <input id="context" type="text" placeholder="Ej: farmacia hospitalaria" autocomplete="off" />
            <div class="ac-dropdown hidden" id="acDrop-context"></div>
          </div>
          <div class="mesh-chips hidden" id="meshChips-context"></div>
          <div class="syn-area" id="synArea-context">
            <div class="syn-chips" id="synChips-context"></div>
            <input class="syn-input" data-field="context" placeholder="+ sinónimo (Enter)" />
          </div>
        </div>
      </div>

      <div class="actions">
        <select id="window">
          <option value="7">7 días</option>
          <option value="30">30 días</option>
          <option value="90">90 días</option>
          <option value="365">1 año</option>
        </select>

        <button id="analyze">Analizar</button>
        <button id="reset" class="secondary" type="button">Reiniciar</button>
        <button id="clearCache" class="secondary" type="button">Limpiar caché</button>
        <button id="print">Imprimir / Guardar PDF</button>
      </div>

      <div id="loadingBox" class="loading-box hidden">
        <span class="spinner"></span>
        <span>Consultando PubMed y ClinicalTrials.gov…</span>
      </div>

      <div id="errorBox" class="error-box hidden"></div>
    </section>

    <!-- Query Builder -->
    <section class="card" id="queryBuilderCard">
      <h2>Estrategia de búsqueda</h2>
      <div class="strategy-human" id="strategyHuman"></div>
      <label class="qb-label">PubMed Query (editable)</label>
      <div class="query-row">
        <textarea id="queryPreview" rows="3" spellcheck="false" placeholder="La query se genera automáticamente…"></textarea>
        <button id="copyQuery" class="secondary" type="button" title="Copiar al portapapeles">Copiar</button>
      </div>
    </section>

    <!-- Resultados -->
    <section id="results" class="card hidden">
      <div class="results-header">
        <h2>Resultados</h2>
        <span id="cacheIndicator" class="cache-badge hidden">Resultados en caché</span>
      </div>
      <div id="report"></div>
    </section>

  </main>

  <script type="module" src="js/app.js?v=20260217_5"></script>

</body>
</html>
